require=function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){return o(e[i][1][r]||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r}()({1:[function(require,module,exports){"use strict";var Lexer=function(tokens){this._t=tokens},lexerSymbols=[",","=",":","(",")","[","]","{","}","@",'"',"'","\\","<",">","$","-","."],lexerWhiteSpace=[" ","\t","\r","\n"];Lexer.prototype.read=function(input){this._input=input,this.line=1,this.offset=0,this.text="",this.token=null,this.backup=null},Lexer.prototype.input=function(){return this.offset<this._input.length?(this.ch=this._input[this.offset++],this.text+=this.ch,"\r"===this.ch?("\n"===this._input[this.offset]&&(this.text+=this._input[this.offset++]),
this.line++):"\n"===this.ch&&this.line++,this.ch):null},Lexer.prototype.unput=function(){this.offset--,this.text=this.text.substring(0,this.text.length-1),this.ch=this._input[this.offset-1];var after=this._input[this.offset];"\n"!==after&&"\r"!==after||("\n"===after&&"\r"===this.ch&&(this.offset--,this.ch=this._input[this.offset-1],this.text=this.text.substring(0,this.text.length-1)),this.line--)},Lexer.prototype.unlex=function(state){return state||(state=this.backup),this.backup=null,state&&(this.offset=state.offset,this.text=state.text,this.token=state.token,this.line=state.line,state.backup&&(this.backup=state.backup)),this.token},Lexer.prototype.state=function(){return{offset:this.offset,text:this.text,token:this.token,line:this.line,backup:this.backup}},Lexer.prototype.lex=function(){for(this.backup=this.state(),this.token=this.next();this.token===this._t.T_WHITESPACE;)this.token=this.next();return this.token},Lexer.prototype.next=function(){this.text="";var ch=this.input()
;if(null===ch)return this._t.T_EOF;if('"'===ch||"'"===ch){var tKey=ch;do{"\\"===(ch=this.input())&&this.input()}while(ch!==tKey&&this.offset<this._input.length);return this._t.T_TEXT}if(lexerSymbols.indexOf(ch)>-1){if("."===ch&&this.offset<this._input.length){var nCh=this._input[this.offset].charCodeAt(0);if(nCh>47&&nCh<58)return this.readNumber()}return":"===ch?ch="=>":"="===ch&&this.offset<this._input.length&&">"===this._input[this.offset]&&(ch+=this.input()),ch}if(lexerWhiteSpace.indexOf(ch)>-1){for(ch=this.input();lexerWhiteSpace.indexOf(ch)>-1;)ch=this.input();return null!==ch&&this.unput(),this._t.T_WHITESPACE}var isNumber=this.readNumber();if(isNumber)return isNumber;do{if(ch=this.input(),lexerSymbols.indexOf(ch)>-1||lexerWhiteSpace.indexOf(ch)>-1){this.unput();break}}while(this.offset<this._input.length);return this._t.T_STRING},Lexer.prototype.readNumber=function(){var ch=this.ch.charCodeAt(0);if(46===ch||ch>47&&ch<58){for(var isFloat=46===ch;46===ch||ch>47&&ch<58;)if(ch=this.input(),
null!==ch&&(ch=ch.charCodeAt(0)),46===ch){if(isFloat)break;isFloat=!0}return null!==ch&&this.unput(),this._t.T_NUM}return null},module.exports=Lexer},{}],2:[function(require,module,exports){"use strict";var extend=function(a,b){if(a){if(Array.isArray(b)){for(var i=0;i<b.length;i++)b[i]&&(a[i]=extend(a[i],b[i]));return a}if("object"==typeof b)return Object.getOwnPropertyNames(b).forEach(function(key){a[key]=extend(a[key],b[key])}),a}return b},docSplit=/^(\s*\*[ \t]*|[ \t]*)(.*)$/gm,Parser=function(lexer,grammar){this.lexer=lexer,this.parsers={type:this.parseType,variable:this.parseVarName,text:this.parseText,version:this.parseVersion,array:this.parseArray,object:this.parseObject,boolean:this.parseBoolean,number:this.parseNumber,string:this.parseString},this.grammar={param:[{property:"type",parser:"type",optional:!0,default:"mixed"},{property:"name",parser:"variable",optional:!0},{property:"description",parser:"text",optional:!0,default:""}],return:[{property:"what",parser:"type",optional:!0,default:!1},{
property:"description",parser:"text",optional:!0,default:""}],throws:[{property:"what",parser:"type",optional:!0,default:"Exception"},{property:"description",parser:"text",optional:!0}],deprecated:[{property:"version",parser:"version",optional:!0,default:{major:0,minor:0,patch:0,label:null}},{property:"description",parser:"text"}]},grammar&&this.extendGrammar(grammar)};Parser.prototype.extendGrammar=function(grammar){this.grammar=extend(this.grammar,grammar)},Parser.prototype.parse=function(input){var ast={kind:"doc",summary:"",body:[]};if(Array.isArray(input))input=input.join("\n");else{input=input.substring(2,input.length-2).split(docSplit);for(var lines=[],i=2;i<input.length;i+=3)lines.push(input[i].trim());input=lines.join("\n")}for(this.lexer.read(input),this.token=this.lexer.lex();this.token!==this.lexer._t.T_EOF&&"@"!==this.token;)this.token=this.lexer.lex();for("@"===this.token?ast.summary=input.substring(0,this.lexer.offset-1):ast.summary=input.substring(0,this.lexer.offset),
"\r"===ast.summary[0]&&(ast.summary=ast.summary.substring(1)),"\n"===ast.summary[0]&&(ast.summary=ast.summary.substring(1)),"\n"===ast.summary[ast.summary.length-1]&&(ast.summary=ast.summary.substring(0,ast.summary.length-1)),"\r"===ast.summary[ast.summary.length-1]&&(ast.summary=ast.summary.substring(0,ast.summary.length-1));this.token!==this.lexer._t.T_EOF;){var node=this.parseTopStatement();node&&ast.body.push(node)}return ast},Parser.prototype.parseTopStatement=function(){var value;return this.token===this.lexer._t.T_STRING?this.parseStatement():this.token===this.lexer._t.T_TEXT?(value=this.lexer.text,this.token=this.lexer.lex(),{kind:"text",value:value}):this.token===this.lexer._t.T_NUM?(value=this.lexer.text,this.token=this.lexer.lex(),{kind:"number",value:parseFloat(value)}):"["===this.token?{kind:"array",value:this.readArray("]")}:"{"===this.token?{kind:"object",value:this.readJson()}:"@"===this.token?this.parseAnnotation():(this.token=this.lexer.lex(),null)},
Parser.prototype.parseAnnotation=function(){var result,item,type;if(this.token=this.lexer.lex(),this.token===this.lexer._t.T_STRING){var line=this.lexer.backup.line;if(type=this.lexer.text.toLowerCase(),this.token=this.lexer.lex(),Array.isArray(this.grammar[type])){var backup=this.lexer.state();if(null!==(result=this.parseGrammar(type)))return result;this.token=this.lexer.unlex(backup)}if("("===this.token)this.token=this.lexer.lex(),result={kind:"annotation",name:type,arguments:this.parseMethodArguments()};else for(result={kind:"block",name:type,options:[]};line===this.lexer.line&&this.token!==this.lexer._t.T_EOF;)null!==(item=this.parseTopStatement())&&result.options.push(item);return result}return null},Parser.prototype.parseMethodArguments=function(){var item,result=[];if(")"===this.token)return this.token=this.lexer.lex(),result;do{item=this.parseTopStatement(),null!==item&&("="!==this.token&&"=>"!==this.token||(this.token=this.lexer.lex(),item={kind:"key",name:this.getJsonValue(item),
value:this.parseTopStatement()}),result.push(item)),","===this.token&&(this.token=this.lexer.lex())}while(")"!==this.token&&this.token!==this.lexer._t.T_EOF);return")"===this.token&&(this.token=this.lexer.lex()),result},Parser.prototype.parseGrammar=function(name){for(var result={kind:name},rules=this.grammar[name],i=0;i<rules.length;i++){var rule=rules[i];result[rule.property]=this.parseRule(rule)}return result},Parser.prototype.parseRule=function(rule){if("function"==typeof this.parsers[rule.parser]){var backup=this.lexer.state(),result=this.parsers[rule.parser].apply(this,[]);return null===result&&(this.lexer.unlex(backup),void 0!==rule.default)?rule.default:result}return null},Parser.prototype.parseType=function(){var result={kind:"type",fqn:!1,name:""};if("\\"===this.token&&(result.fqn=!0,this.token=this.lexer.lex()),this.token!==this.lexer._t.T_STRING)return null;for(;this.token===this.lexer._t.T_STRING;){if(result.name+=this.lexer.text,this.token=this.lexer.lex(),"\\"!==this.token){
if("["===this.token){if(result={kind:"collection",value:result,index:this.parseListOfTypes("]")},null===result.index)return null;break}if("<"===this.token){if(result={kind:"class",class:result,parameters:this.parseListOfTypes(">")},null===result.parameters)return null;break}break}result.name+="\\",this.token=this.lexer.lex()}return result},Parser.prototype.parseListOfTypes=function(charEnd){var result=[];if(this.token=this.lexer.lex(),this.token===charEnd)this.token=this.lexer.lex();else{var indexType=this.parseType();if(null!==indexType)for(result.push(indexType);","===this.token;)this.token=this.lexer.lex(),null!==(indexType=this.parseType())&&result.push(indexType);this.token===charEnd&&(this.token=this.lexer.lex())}return result},Parser.prototype.parseVarName=function(){if("$"===this.token&&(this.token=this.lexer.lex(),this.token===this.lexer._t.T_STRING)){var result=this.lexer.text;return this.token=this.lexer.lex(),result}return null},Parser.prototype.parseText=function(){
if(this.token!==this.lexer._t.T_STRING)return null;for(var ch=this.lexer.input();null!==ch&&"\r"!==ch&&"\n"!==ch&&"\r\n"!==ch;)ch=this.lexer.input();var input=this.lexer.text.trim();return this.token=this.lexer.lex(),input},Parser.prototype.parseVersion=function(){var version={major:0,minor:0,patch:0,label:null};if(this.token!==this.lexer._t.T_NUM)return null;var v=this.lexer.text;return this.token=this.lexer.lex(),this.token===this.lexer._t.T_NUM&&(v+=this.lexer.text,this.token=this.lexer.lex()),"-"===this.token&&(this.token=this.lexer.lex(),this.token===this.lexer._t.T_STRING&&(version.label=this.lexer.text,this.token=this.lexer.lex(),this.token===this.lexer._t.T_NUM&&(version.label+=this.lexer.text,this.token=this.lexer.lex()))),v=v.split("."),version.major=parseInt(v[0],10),v.length>1&&(version.minor=parseInt(v[1],10),v.length>2&&(version.patch=parseInt(v[2],10))),version},Parser.prototype.parseArray=function(){
return"["===this.token?this.readArray("]"):"array"===this.lexer.text.toLowerCase()&&(this.token=this.lexer.lex(),"("===this.token)?this.readArray(")"):null},Parser.prototype.parseObject=function(){return"{"===this.token?this.readJson():null},Parser.prototype.parseBoolean=function(){if(this.token===this.lexer._t.T_STRING){var word=this.lexer.text.toLowerCase();if(this.token=this.lexer.lex(),"true"===word)return!0;if("false"===word)return!1}return null},Parser.prototype.parseNumber=function(){if(this.token===this.lexer._t.T_NUM){var word=this.lexer.text;return this.token=this.lexer.lex(),parseFloat(word)}return null},Parser.prototype.parseString=function(){if(this.token===this.lexer._t.T_TEXT){var text=this.lexer.text.substring(1,this.lexer.text.length-1);return this.token=this.lexer.lex(),text}return null},Parser.prototype.parseStatement=function(){var word=this.lexer.text.toLowerCase();if("true"===word)return this.token=this.lexer.lex(),{kind:"boolean",value:!0}
;if("false"===word)return this.token=this.lexer.lex(),{kind:"boolean",value:!1};if("null"===word)return this.token=this.lexer.lex(),{kind:"null"};if("array"===word)return this.token=this.lexer.lex(),"("===this.token?{kind:"array",value:this.readArray(")")}:{kind:"word",value:this.lexer.backup.text};var name=this.lexer.text;return this.token=this.lexer.lex(),"="===this.token||"=>"===this.token?(this.token=this.lexer.lex(),{kind:"key",name:name,value:this.getJsonValue(this.parseTopStatement())}):"("===this.token?(this.token=this.lexer.lex(),{kind:"method",name:name,arguments:this.parseMethodArguments()}):{kind:"word",value:name}},Parser.prototype.readArray=function(endChar){var result=[];if(this.token=this.lexer.lex(),this.token===endChar)return this.token=this.lexer.lex(),result;do{var item=this.parseTopStatement();if(null!==item){if(item=this.getJsonValue(item),result.push(item),","!==this.token)break;this.token=this.lexer.lex()}}while(this.token!==endChar&&this.token!==this.lexer._t.T_EOF)
;return this.token===endChar&&(this.token=this.lexer.lex()),result},Parser.prototype.readJson=function(){var result={};this.token=this.lexer.lex();do{var item=this.parseTopStatement();if(null!==item){if("key"===item.kind?result[item.name]=item.value:"=>"===this.token&&null!==(item=this.getJsonKey(item))&&(this.token=this.lexer.lex(),result[item]=this.getJsonValue(this.parseTopStatement())),","!==this.token)break;this.token=this.lexer.lex()}}while("}"!==this.token&&this.token!==this.lexer._t.T_EOF);return"}"===this.token&&(this.token=this.lexer.lex()),result},Parser.prototype.getJsonValue=function(ast){if(!ast)return null;var result=this.getJsonKey(ast);return null===result&&("object"===ast.kind?result=ast.value:"array"===ast.kind?(result=[],ast.value.forEach(function(item){result.push(this.getJsonValue(item))}.bind(this))):result=ast),result},Parser.prototype.getJsonKey=function(ast){var result=null;if("text"===ast.kind){result=ast.value.substring(1,ast.value.length-1);try{result=JSON.parse('"'+result+'"')
}catch(err){}}else"number"===ast.kind?result=JSON.parse(ast.value):"word"!==ast.kind&&"boolean"!==ast.kind||(result=ast.value);return result},module.exports=Parser},{}],3:[function(require,module,exports){"use strict";module.exports={T_EOF:1,T_WHITESPACE:2,T_TEXT:3,T_STRING:4,T_NUM:5}},{}],"doc-parser":[function(require,module,exports){"use strict";var token=require("./token"),Lexer=require("./lexer"),Parser=require("./parser"),API=function(grammar){this.token=token,this.lexer=new Lexer(this.token),this.parser=new Parser(this.lexer,grammar)};API.prototype.parse=function(input){return this.parser.parse(input)},module.exports=API},{"./lexer":1,"./parser":2,"./token":3}]},{},[]);
//# sourceMappingURL=doc-parser.min.js.map